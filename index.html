<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shop</title>

    <!-- Your CSS styles -->
    <style>
        /* Your CSS styles go here */
    </style>
</head>
<body>
    <div class="container">
        <div id="main">
            <!-- Your existing content here -->
        </div>
        <form id="form">
            <input type="text" placeholder="Имя" id="user_name">
            <input type="text" placeholder="Телефон" id="user_phone">
            <input type="text" placeholder="Емайл" id="user_email">
            <button id="order" class="button">Оформить</button>
        </form>
        <p id="error"></p>
    </div>

    <!-- Your existing JavaScript scripts and Telegram WebApp script -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script>
        let tg = window.Telegram.WebApp;
        let order = document.getElementById("order");
        let mainSection = document.getElementById("main");
        let formSection = document.getElementById("form");

        order.addEventListener("click", async () => {
            event.preventDefault();

            document.getElementById("error").innerText = '';
            let name = document.getElementById("user_name").value;
            let email = document.getElementById("user_email").value;
            let phone = document.getElementById("user_phone").value;

            if (name.trim() === '' || email.trim() === '' || phone.trim() === '') {
                document.getElementById("error").innerText = "Впишите требуюмую информацию, а то по ебалу получишь";
                return;
            }

            if (name.length < 4) {
                document.getElementById("error").innerText = "Имя должно содержать не менее 4 символов";
                return;
            }

            if (!email.includes("@")) {
                document.getElementById("error").innerText = "Некорректный адрес электронной почты";
                return;
            }

            if (!/^\d{8}$/.test(phone)) {
                document.getElementById("error").innerText = "Некорректный номер телефона";
                return;
            }

            let data = {
                name: name,
                email: email,
                phone: phone
            };

            try {
                // Make the HTTP POST request to your api.php file on the server
                const response = await fetch('api.php', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(data)
                });

                if (response.ok) {
                    console.log('Data sent to the server successfully');
                    // You can display a success message to the user if you want
                    // For example: document.getElementById('error').innerText = 'Data sent to the server successfully';
                } else {
                    console.error('Error sending data to the server');
                    // You can display an error message to the user if you want
                    // For example: document.getElementById('error').innerText = 'Error sending data to the server';
                }
            } catch (error) {
                console.error('An error occurred while sending data:', error);
                // You can display an error message to the user if you want
                // For example: document.getElementById('error').innerText = 'An error occurred while sending data';
            }
        });
    </script>
</body>
</html>
